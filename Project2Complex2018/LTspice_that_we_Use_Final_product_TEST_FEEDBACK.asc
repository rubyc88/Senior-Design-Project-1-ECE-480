Version 4
SHEET 1 4520 696
WIRE 1584 -1072 1584 -1120
WIRE 2464 -1056 2304 -1056
WIRE 2640 -1056 2464 -1056
WIRE 1584 -1040 1584 -1072
WIRE 2304 -992 2304 -1056
WIRE 2304 -992 2288 -992
WIRE 2336 -992 2304 -992
WIRE 2464 -992 2464 -1056
WIRE 2464 -992 2416 -992
WIRE 2528 -992 2464 -992
WIRE 2640 -992 2640 -1056
WIRE 2640 -992 2608 -992
WIRE 2688 -992 2640 -992
WIRE 2864 -992 2768 -992
WIRE 3152 -992 2864 -992
WIRE 3536 -992 3152 -992
WIRE 2464 -976 2464 -992
WIRE 1584 -928 1584 -960
WIRE 2464 -880 2464 -912
WIRE 2720 -832 2624 -832
WIRE 2864 -832 2864 -992
WIRE 2864 -832 2720 -832
WIRE 3536 -832 3536 -992
WIRE 3696 -832 3536 -832
WIRE 3760 -832 3696 -832
WIRE 2720 -816 2720 -832
WIRE 3696 -816 3696 -832
WIRE 1456 -800 1456 -816
WIRE 1584 -800 1584 -816
WIRE 2064 -800 2064 -832
WIRE 2624 -800 2624 -832
WIRE 2864 -800 2864 -832
WIRE 2992 -800 2864 -800
WIRE 3536 -800 3536 -832
WIRE 3536 -800 3408 -800
WIRE 3760 -800 3760 -832
WIRE 2224 -784 2208 -784
WIRE 2272 -784 2224 -784
WIRE 2528 -784 2464 -784
WIRE 2544 -784 2528 -784
WIRE 1456 -768 1456 -800
WIRE 1584 -768 1584 -800
WIRE 1840 -768 1840 -784
WIRE 2992 -768 2992 -800
WIRE 3408 -768 3408 -800
WIRE 1776 -752 1712 -752
WIRE 2864 -736 2864 -800
WIRE 3536 -736 3536 -800
WIRE 1952 -720 1920 -720
WIRE 1968 -720 1952 -720
WIRE 2016 -720 1968 -720
WIRE 2208 -720 2208 -784
WIRE 2208 -720 2160 -720
WIRE 2624 -720 2624 -736
WIRE 2720 -720 2720 -736
WIRE 2720 -720 2624 -720
WIRE 2768 -720 2720 -720
WIRE 2816 -720 2768 -720
WIRE 3664 -720 3584 -720
WIRE 3696 -720 3696 -736
WIRE 3696 -720 3664 -720
WIRE 3760 -720 3760 -736
WIRE 3760 -720 3696 -720
WIRE 1968 -688 1936 -688
WIRE 2624 -688 2624 -720
WIRE 3760 -688 3760 -720
WIRE 1456 -656 1456 -688
WIRE 1584 -656 1584 -688
WIRE 2208 -656 2160 -656
WIRE 3120 -656 3104 -656
WIRE 3216 -656 3184 -656
WIRE 1936 -640 1936 -688
WIRE 2208 -592 2208 -656
WIRE 2240 -592 2208 -592
WIRE 2272 -592 2240 -592
WIRE 2528 -592 2464 -592
WIRE 2624 -592 2624 -624
WIRE 3760 -592 3760 -624
WIRE 3808 -592 3760 -592
WIRE 1472 -576 1424 -576
WIRE 1600 -576 1552 -576
WIRE 2864 -560 2864 -640
WIRE 2864 -560 2832 -560
WIRE 2976 -560 2864 -560
WIRE 3072 -560 3056 -560
WIRE 3104 -560 3104 -656
WIRE 3104 -560 3072 -560
WIRE 3120 -560 3104 -560
WIRE 3216 -560 3216 -656
WIRE 3216 -560 3200 -560
WIRE 3248 -560 3216 -560
WIRE 3280 -560 3248 -560
WIRE 3536 -560 3536 -640
WIRE 3536 -560 3360 -560
WIRE 3568 -560 3536 -560
WIRE 1072 -544 1072 -592
WIRE 2336 -528 2336 -720
WIRE 1424 -480 1424 -576
WIRE 1472 -480 1424 -480
WIRE 1600 -480 1600 -576
WIRE 1600 -480 1536 -480
WIRE 2864 -432 2864 -560
WIRE 3136 -432 2864 -432
WIRE 3536 -432 3536 -560
WIRE 3536 -432 3184 -432
WIRE 2064 -416 2064 -464
WIRE 2864 -416 2864 -432
WIRE 3536 -416 3536 -432
WIRE 1056 -400 1040 -400
WIRE 1072 -400 1072 -464
WIRE 1072 -400 1056 -400
WIRE 1152 -400 1136 -400
WIRE 1216 -400 1152 -400
WIRE 1312 -400 1296 -400
WIRE 1360 -400 1312 -400
WIRE 1424 -400 1424 -480
WIRE 1424 -400 1360 -400
WIRE 1456 -400 1424 -400
WIRE 1600 -400 1600 -480
WIRE 1664 -400 1600 -400
WIRE 1712 -400 1712 -752
WIRE 1712 -400 1664 -400
WIRE 2240 -400 2208 -400
WIRE 2272 -400 2240 -400
WIRE 2576 -400 2464 -400
WIRE 2592 -400 2576 -400
WIRE 1840 -384 1840 -400
WIRE 3136 -384 3136 -432
WIRE 3136 -384 3120 -384
WIRE 3184 -384 3184 -432
WIRE 3216 -384 3184 -384
WIRE 1456 -368 1456 -400
WIRE 1472 -368 1456 -368
WIRE 3120 -368 3120 -384
WIRE 3216 -368 3216 -384
WIRE 1600 -352 1600 -400
WIRE 1600 -352 1536 -352
WIRE 1040 -336 1040 -400
WIRE 1472 -336 1456 -336
WIRE 1936 -336 1920 -336
WIRE 1968 -336 1936 -336
WIRE 2016 -336 1968 -336
WIRE 2208 -336 2208 -400
WIRE 2208 -336 2160 -336
WIRE 2336 -336 2336 -528
WIRE 2768 -336 2752 -336
WIRE 2816 -336 2768 -336
WIRE 3616 -336 3584 -336
WIRE 1456 -320 1456 -336
WIRE 1712 -304 1712 -400
WIRE 1776 -304 1712 -304
WIRE 1968 -304 1936 -304
WIRE 2864 -304 2864 -320
WIRE 3536 -304 3536 -320
WIRE 3152 -288 3120 -288
WIRE 3216 -288 3184 -288
WIRE 2208 -272 2160 -272
WIRE 3040 -272 2992 -272
WIRE 3152 -272 3152 -288
WIRE 3152 -272 3120 -272
WIRE 3184 -272 3184 -288
WIRE 3248 -272 3184 -272
WIRE 1936 -256 1936 -304
WIRE 3152 -256 3152 -272
WIRE 3184 -256 3184 -272
WIRE 2208 -224 2208 -272
WIRE 2256 -224 2208 -224
WIRE 2272 -224 2256 -224
WIRE 2576 -224 2464 -224
WIRE 2992 -224 2992 -272
WIRE 1040 -208 1040 -256
WIRE 3248 -192 3248 -272
WIRE 2336 -160 2336 -336
WIRE 1312 -112 1312 -400
WIRE 1792 -112 1312 -112
WIRE 2880 -112 1872 -112
WIRE 3168 -112 3168 -192
WIRE 3168 -112 2880 -112
WIRE 3248 -112 3168 -112
WIRE 2336 -32 2336 -160
WIRE 1408 32 1376 32
WIRE 1504 32 1408 32
WIRE 1408 48 1408 32
WIRE 1504 48 1504 32
WIRE 2160 96 2048 96
WIRE 2400 96 2240 96
WIRE 1408 144 1408 128
WIRE 1504 144 1504 112
WIRE 1504 144 1408 144
WIRE 1408 160 1408 144
WIRE 1504 160 1504 144
WIRE 1728 160 1568 160
WIRE 1984 208 1984 160
WIRE 2048 208 2048 96
WIRE 2048 208 1984 208
WIRE 2192 208 2160 208
WIRE 2256 208 2192 208
WIRE 2400 208 2400 96
WIRE 2400 208 2368 208
WIRE 1568 224 1568 160
WIRE 1584 224 1568 224
WIRE 1728 240 1728 160
WIRE 1728 240 1648 240
WIRE 1792 240 1728 240
WIRE 1408 256 1408 240
WIRE 1504 256 1504 224
WIRE 1504 256 1408 256
WIRE 1584 256 1504 256
WIRE 2192 256 2192 208
WIRE 1408 272 1408 256
WIRE 1504 272 1504 256
WIRE 1984 288 1984 208
WIRE 1408 368 1408 352
WIRE 1504 368 1504 336
WIRE 1504 368 1408 368
WIRE 1408 400 1408 368
WIRE 1504 400 1504 368
WIRE 1984 400 1984 352
WIRE 1408 496 1408 480
WIRE 1504 496 1504 464
FLAG 1040 -208 0
FLAG 1056 -400 Vin
FLAG 1456 -656 0
FLAG 1456 -800 Vdd
FLAG 2864 -304 0
FLAG 2288 -992 Vs
FLAG 1584 -656 0
FLAG 1584 -800 Vs
FLAG 2768 -720 Vg2
FLAG 1360 -400 Vsum
FLAG 3536 -304 0
FLAG 3664 -720 Vg4
FLAG 2880 -112 Vfb
FLAG 2832 -560 VoL
FLAG 3568 -560 VoR
FLAG 1152 -400 Vindc
FLAG 1584 -928 0
FLAG 1584 -1072 clock
FLAG 3280 -864 Vfilter
FLAG 3616 -336 Vg3
FLAG 3808 -592 Vg4b
FLAG 3072 -912 VoL
FLAG 3072 -816 VoR
FLAG 3072 -560 Vll
FLAG 3248 -560 Vlr
FLAG 2464 -880 0
FLAG 3152 -992 Vsd
FLAG 2768 -336 Vg1
FLAG 2624 -592 Vg2b
FLAG 1840 -400 Vdd
FLAG 1776 -688 Vref1
FLAG 1840 -784 Vdd
FLAG 1776 -368 Vref2
FLAG 1664 -400 Vint
FLAG 2592 -400 Vg1
FLAG 2544 -784 Vg3
FLAG 2576 -224 Vg4b
FLAG 2528 -592 Vg2b
FLAG 2368 -832 Vdd
FLAG 2368 -640 Vdd
FLAG 2368 -448 Vdd
FLAG 2368 -272 Vdd
FLAG 2368 -736 0
FLAG 2368 -544 0
FLAG 2368 -352 0
FLAG 2368 -176 0
FLAG 1936 -640 clock
FLAG 1952 -720 Comp1
FLAG 2064 -832 Q2
FLAG 1936 -256 clock
FLAG 1936 -336 Comp2
FLAG 2064 -464 Q1
FLAG 2064 -576 Vdd
FLAG 2064 -192 Vdd
FLAG 2256 -224 _Q2
FLAG 2224 -784 Q1
FLAG 2240 -400 Q2
FLAG 2240 -592 _Q1
FLAG 2336 -32 _POR
FLAG 1072 -592 0
FLAG 1456 -320 VCM
IOPIN 1456 -320 In
FLAG 1504 -384 Vdd
FLAG 1504 -320 0
FLAG 1504 496 0
FLAG 1408 496 0
FLAG 1376 32 VDD
FLAG 1504 144 Vref1
FLAG 1504 368 Vref2
FLAG 1616 208 Vdd
FLAG 1792 240 VCM
FLAG 1616 272 0
FLAG 1984 400 0
FLAG 1984 80 Vdd
FLAG 2192 256 _POR
FLAG 2464 -304 VDD
FLAG 2576 -320 0
FLAG 2464 -672 VDD
FLAG 2528 -704 0
FLAG 2992 -704 0
FLAG 3408 -704 0
FLAG 2992 -224 VCM
FLAG 3136 -224 0
FLAG 3200 -224 Vdd
SYMBOL voltage 1040 -352 R0
WINDOW 123 48 45 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 45 69 Left 2
WINDOW 0 6 15 Left 2
SYMATTR Value2 AC 1
SYMATTR Value SINE(0 0.5 {freq})
SYMATTR InstName Vin
SYMBOL voltage 1456 -784 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 -3 14 Left 2
SYMATTR InstName VDD
SYMATTR Value 5
SYMBOL res 1200 -384 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value {Rin}
SYMBOL cap 1536 -496 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName Cint
SYMATTR Value {Cint}
SYMATTR Value2 ic=0
SYMBOL res 1776 -96 R270
WINDOW 0 28 15 VTop 2
WINDOW 3 56 109 VBottom 2
SYMATTR InstName R2
SYMATTR Value {Rf}
SYMBOL voltage 1584 -784 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vs
SYMATTR Value 12
SYMBOL res 2736 -720 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL cap 2640 -624 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C3
SYMATTR Value 100n
SYMBOL res 3680 -720 M180
WINDOW 0 -45 73 Left 2
WINDOW 3 -41 42 Left 2
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL cap 3776 -624 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C4
SYMATTR Value 100n
SYMBOL cap 1072 -384 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C8
SYMATTR Value {Cb}
SYMBOL schottky 2640 -736 R180
WINDOW 0 24 72 Left 2
WINDOW 3 -40 109 Left 2
SYMATTR InstName D3
SYMATTR Value 1N5818
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 3776 -736 R180
WINDOW 0 -36 34 Left 2
WINDOW 3 -72 -13 Left 2
SYMATTR InstName D4
SYMATTR Value 1N5818
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL nmos 2816 -416 R0
WINDOW 3 106 20 VRight 2
SYMATTR Value irf7309n10
SYMATTR InstName M1
SYMATTR Prefix X
SYMBOL pmos 2816 -640 M180
SYMATTR InstName M2
SYMATTR Value irf7309p
SYMATTR Prefix X
SYMBOL nmos 3584 -416 M0
WINDOW 3 103 130 VLeft 2
SYMATTR Value irf7309n10
SYMATTR InstName M3
SYMATTR Prefix X
SYMBOL pmos 3584 -640 R180
SYMATTR InstName M4
SYMATTR Value irf7309p
SYMATTR Prefix X
SYMBOL voltage 1584 -1056 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 94 -115 Left 2
WINDOW 0 -1 13 Left 2
SYMATTR Value PULSE(0 5 0 {.1/fclk} {.1/fclk} {.5/fclk} {1/fclk})
SYMATTR InstName VClk
SYMBOL DiffLPF 3088 -848 R0
SYMATTR InstName X1
SYMBOL res 3104 -544 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName Rout
SYMATTR Value 8
SYMBOL ind 2960 -544 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 33µ
SYMBOL ind 3264 -544 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 33µ
SYMBOL cap 3120 -640 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C1
SYMATTR Value .047µ
SYMBOL cap 2448 -976 R0
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL voltage 2672 -992 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName Vsense
SYMATTR Value 0
SYMBOL res 1456 -560 R270
WINDOW 0 -16 108 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R6
SYMATTR Value 1Meg
SYMBOL ideal_comparator 1792 -720 R0
SYMATTR InstName X2
SYMBOL ideal_comparator 1792 -336 R0
SYMATTR InstName X3
SYMBOL 74hc74 2064 -416 R0
SYMATTR InstName U1
SYMBOL 74hc74 2064 -800 R0
SYMATTR InstName U2
SYMBOL 74act240sim_oe 2288 -848 R0
SYMATTR InstName X8
SYMBOL 74act240sim_oe 2288 -656 R0
SYMATTR InstName X4
SYMBOL 74act240sim_oe 2288 -464 R0
SYMATTR InstName X5
SYMBOL 74act240sim_oe 2288 -288 R0
SYMATTR InstName X6
SYMBOL ind 2624 -1008 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Ltrace
SYMATTR Value 1n
SYMBOL ind 2432 -1008 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Lwire
SYMATTR Value 10n
SYMBOL res 1088 -448 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value {Rp}
SYMBOL opamps\\UniversalOpamp2 720 -560 R0
WINDOW 38 12 24 Left 2
SYMATTR InstName U3
SYMATTR Value2 Avol=100K GBW=5.6Meg Slew=2Meg
SYMATTR SpiceLine ilimit=40m rail=0 Vos=3.5m phimargin=45
SYMATTR SpiceLine2 en=24n enk=100 in=0.25p ink=100 Rin=12Meg
SYMBOL Opamps\\opamp2 1504 -416 R0
WINDOW 3 9 -6 Left 0
SYMATTR Value LMV796
SYMATTR InstName U4
SYMBOL res 1392 32 R0
SYMATTR InstName R5
SYMATTR Value {R0}
SYMBOL res 1392 144 R0
SYMATTR InstName R9
SYMATTR Value {R1}
SYMBOL res 1392 256 R0
SYMATTR InstName R10
SYMATTR Value {R1}
SYMBOL res 1392 384 R0
SYMATTR InstName R12
SYMATTR Value {R0}
SYMBOL cap 1488 48 R0
SYMATTR InstName C5
SYMATTR Value {Cb1}
SYMBOL cap 1488 160 R0
SYMATTR InstName C6
SYMATTR Value {Cb1}
SYMBOL cap 1488 272 R0
SYMATTR InstName C7
SYMATTR Value {Cb1}
SYMBOL cap 1488 400 R0
SYMATTR InstName C9
SYMATTR Value {Cb1}
SYMBOL opamps\\UniversalOpamp2 1616 240 R0
WINDOW 38 12 24 Left 2
SYMATTR InstName U5
SYMATTR Value2 Avol=100K GBW=5.6Meg Slew=2Meg
SYMATTR SpiceLine ilimit=40m rail=0 Vos=3.5m phimargin=45
SYMATTR SpiceLine2 en=24n enk=100 in=0.25p ink=100 Rin=12Meg
SYMBOL Opamps\\opamp2 720 -496 R0
WINDOW 3 9 -6 Left 0
SYMATTR Value LMV796
SYMATTR InstName U6
SYMBOL 74hc04 2096 144 R0
SYMATTR InstName U7
SYMBOL 74hc04 2304 144 R0
SYMATTR InstName U8
SYMBOL res 1968 64 R0
SYMATTR InstName R3
SYMATTR Value 3.1k
SYMBOL res 2256 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 5k
SYMBOL cap 1968 288 R0
SYMATTR InstName C10
SYMATTR Value 100n
SYMBOL res 2448 -320 R0
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res 2560 -416 R0
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL res 2448 -688 R0
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL res 2512 -800 R0
SYMATTR InstName R16
SYMATTR Value 10k
SYMBOL cap 2976 -768 R0
WINDOW 3 33 23 Left 2
SYMATTR InstName C11
SYMATTR Value 1µ
SYMBOL cap 3392 -768 R0
WINDOW 3 36 26 Left 2
SYMATTR InstName C12
SYMATTR Value 1µ
SYMBOL Opamps\\opamp2 3232 -224 R90
WINDOW 3 9 -6 Left 0
SYMATTR Value LMV796
SYMATTR InstName U9
SYMBOL res 3104 -384 R0
WINDOW 3 -65 -10 Left 2
SYMATTR InstName R17
SYMATTR Value {R1test}
SYMBOL res 3200 -384 R0
WINDOW 3 -2 -10 Left 2
SYMATTR InstName R18
SYMATTR Value {R1test}
SYMBOL res 3232 -208 R0
SYMATTR InstName R19
SYMATTR Value {R2test}
SYMBOL res 3136 -288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value {R2test}
TEXT 3912 -528 Left 2 !.tran 0 {2m+100n} 100n
TEXT 3576 -1144 Left 2 !.include irf7309n.spi
TEXT 2704 -664 VRight 2 !.ic V(Vg2)=12\n.ic V(Vg1)=0
TEXT 3656 -560 Left 2 !.ic V(Vg4)=12\n.ic V(Vg3)=0
TEXT 1088 -256 Left 2 !.ic V(Vindc)=2.5
TEXT 1688 -1008 Left 2 !.param fclk=1e6
TEXT 3576 -1112 Left 2 !.include irf7309p.spi
TEXT 3288 -1208 Left 2 !.options gmin=1e-9\n.options abstol=1e-9\n.options reltol=0.006\n.options plotwinsize=0
TEXT 3296 -1096 Left 2 !.options cshunt=1e-15
TEXT 1800 -512 Left 2 !.ic V(Vint)=2.5
TEXT 2112 -536 Left 2 !.ic v(Q1)=5\n.ic v(Q2)=5\n.ic v(_Q1)=0\n.ic v(_Q2)=0
TEXT 3576 -1080 Left 2 !.include 74hc_v_fast.lib
TEXT 1488 -208 Left 2 ;OP_AMP\n MODEL
TEXT 3104 -480 Left 2 ;DIFF AMP\n  MODEL
TEXT 2056 -936 Left 2 !.param A=0.1885
TEXT 3344 -1064 Left 2 ;Convergence\n   Settings
TEXT 3624 -1040 Left 2 ;H-Bridge and\nFlip-Flop Models
TEXT 3040 -736 Left 2 ;External Low Pass Filter\nand 8 Ohm Speaker Load
TEXT 3128 -968 Left 2 ;Speaker and Hearing\nLow Pass Filter Model
TEXT 2056 -1008 Left 2 !.param Cb=4.7u
TEXT 2056 -1056 Left 2 !.param Rp=1.5k
TEXT 2056 -1032 Left 2 !.param Rin=2.2k
TEXT 2056 -984 Left 2 !.param Cint=150p
TEXT 2056 -960 Left 2 !.param Rf=3.3k
TEXT 3760 -400 Left 2 !.four {freq} 5 {3} V(Vll,Vlr)
TEXT 3760 -376 Left 2 !.measure tran pout avg V(Vll,Vlr)*I(Rout)\n.meas TRAN pin AVG {12}*I(Vsense)\n.measure tran efficiency param pout/pin
TEXT 3760 -296 Left 2 !.meas tran ppout pp V(Vll,Vlr)\n.meas tran ppin pp V(Vin)\n.meas tran gain param ppout/ppin
TEXT 1680 -984 Left 2 ;.step param fclk 1e6 2e6 100k
TEXT 1680 -960 Left 2 ;.step param fclk 100k 2e6 100k
TEXT 3752 96 Left 2 ;.step param Rf 2k 10k 1k
TEXT 3752 144 Left 2 ;.step param Rin list 2k 2.2k 2.4k 2.7k 3k
TEXT 3752 40 Left 2 ;.step param Rin list 2k 2.2k 2.4k
TEXT 3752 120 Left 2 ;.step param Cb 1u 2u 1u
TEXT 3752 64 Left 2 ;.step param Cb list 1u 2u 4.7u 10u
TEXT 3912 -464 Left 2 ;.tran 0 {40m+100n} 10m
TEXT 3968 -488 Left 2 ;100 Hz tests
TEXT 3944 -552 Left 2 ;1k and 20k tests
TEXT 2056 -912 Left 2 !.param freq=1k
TEXT 3912 -592 Left 2 ;.Tran Test for Simulation
TEXT 3784 0 Left 2 ;.Param for Stepping Componets
TEXT 3784 -432 Left 2 ;THD & Efficiency &Output Power & Gain
TEXT 2088 -1088 Left 2 ;Set Params
TEXT 1728 -1040 Left 2 ;Set Clock and Stepping
TEXT 3744 -160 Left 2 !.meas tran P1 avg V(VoL)*Ix(M1:D)+V(Vg1)*Ix(M1:G)\n.meas tran P2 avg V(VoL)*Ix(M2:D)+V(Vg2)*Ix(M2:G)+V(Vsd)*Ix(M2:S)\n.meas tran P3 avg V(VoR)*Ix(M4:D)+V(Vg4)*Ix(M4:G)+V(Vsd)*Ix(M4:S)\n.meas tran P4 avg V(VoR)*Ix(M3:D)+V(Vg3)*Ix(M3:G)\n.meas tran bridge param P1+P2+P3+P4
TEXT 3856 -192 Left 2 ;Power Dissipation at H bridge Transistors
TEXT 1664 -848 Left 2 ;H-Bridge Control
TEXT 3224 -480 Left 2 ;Feedback Filter
TEXT 2616 -880 Left 2 ;Level Shifter
TEXT 3672 -880 Left 2 ;Level Shifter
TEXT 1536 -1160 Left 2 ;Clock\nGenerator
TEXT 2088 -32 Left 2 ;Power-On\nReset
TEXT 1024 -680 Left 2 ;Input\nFilter
TEXT 3272 -656 Left 2 ;Output
TEXT 3592 -272 Left 2 ;H-Bridge
TEXT 1408 -872 Left 2 ;Voltage\nRegulator
TEXT 1328 -232 Left 2 ;Integrating\nAmplifier
TEXT 2488 -1152 Left 2 !.include National.lib
TEXT 1224 408 Left 2 !.param R1=470
TEXT 1224 432 Left 2 !.param R0=10k
TEXT 1224 384 Left 2 !.param Cb1=1p
TEXT 1448 -56 Left 2 ;Refrence Generator
TEXT 3304 -24 Left 2 !.param R2test=562
TEXT 3352 48 Left 2 !.param R1test=9k
LINE Normal 1120 -640 1024 -640 2
LINE Normal 1120 -448 1120 -640 2
LINE Normal 1296 -448 1120 -448 2
LINE Normal 1024 -640 992 -640 2
LINE Normal 1296 -320 1296 -448 2
LINE Normal 992 -320 1296 -320 2
LINE Normal 992 -640 992 -320 2
LINE Normal 2784 -768 2912 -768 1
LINE Normal 2704 -400 2768 -400 1
LINE Normal 2704 -256 2704 -400 1
LINE Normal 2960 -256 2704 -256 1
LINE Normal 2960 -496 2960 -256 1
LINE Normal 3440 -496 2960 -496 1
LINE Normal 3440 -256 3440 -496 1
LINE Normal 3696 -256 3440 -256 1
LINE Normal 3696 -464 3696 -256 1
LINE Normal 3600 -464 3696 -464 1
LINE Normal 3600 -768 3600 -464 1
LINE Normal 2912 -768 3600 -768 1
LINE Normal 2912 -768 2912 -768 2
LINE Normal 2784 -400 2784 -768 1
LINE Normal 2768 -400 2784 -400 1
LINE Normal 2256 16 1968 16 2
LINE Normal 2256 64 2256 16 2
LINE Normal 2432 64 2256 64 2
LINE Normal 2432 432 2432 64 2
LINE Normal 1952 432 2432 432 2
LINE Normal 1952 16 1952 432 2
LINE Normal 1968 16 1952 16 2
LINE Normal 1968 16 1968 16 2
LINE Normal 1968 16 1968 16 2
RECTANGLE Normal 3552 -1008 3280 -1264 1
RECTANGLE Normal 3840 -960 3568 -1168 1
RECTANGLE Normal 2968 -756 3372 -516 2
RECTANGLE Normal 3004 -980 3368 -772 2
RECTANGLE Normal 4176 -448 3904 -576 2
RECTANGLE Normal 4176 160 3744 16 2
RECTANGLE Normal 4208 -224 3744 -416 2
RECTANGLE Normal 2016 -944 1680 -1024 2
RECTANGLE Normal 2256 -896 2048 -1072 2
RECTANGLE Normal 4480 -32 3728 -176 2
RECTANGLE Normal 2544 -144 1664 -832 1
RECTANGLE Normal 2752 -496 2592 -864 2
RECTANGLE Normal 3872 -512 3648 -864 2
RECTANGLE Normal 1648 -896 1536 -1120 2
RECTANGLE Normal 1520 -624 1408 -832 2
RECTANGLE Normal 1648 -144 1408 -592 1
RECTANGLE Normal 1872 544 1216 -32 2
